<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PII Detector - DOM Scanning Test</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 800px;
      margin: 50px auto;
      padding: 20px;
    }
    h1 {
      color: #333;
    }
    .content-box {
      background: #f5f5f5;
      padding: 20px;
      border-radius: 8px;
      margin: 20px 0;
    }
    .test-data {
      background: #e3f2fd;
      padding: 15px;
      border-radius: 8px;
      margin-top: 20px;
    }
    button {
      background: #667eea;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      margin: 5px;
    }
    button:hover {
      background: #5568d3;
    }
    #dynamic-content {
      min-height: 50px;
      background: #fff3cd;
      padding: 15px;
      border-radius: 8px;
      margin: 20px 0;
    }
  </style>
</head>
<body>
  <h1>DOM Content Scanning Test</h1>
  <p>This page tests DOM scanning for PII in visible page content.</p>

  <div class="content-box">
    <h2>Static Content with PII</h2>
    <p>Contact Information:</p>
    <ul>
      <li>Email: john.doe@example.com</li>
      <li>Phone: (555) 123-4567</li>
      <li>Secondary Email: jane.smith@company.org</li>
    </ul>

    <p>System Information:</p>
    <ul>
      <li>Server IP: 192.168.1.100</li>
      <li>Public IP: 203.0.113.42</li>
    </ul>

    <p>Sensitive IDs:</p>
    <ul>
      <li>SSN: 987-65-4321</li>
      <li>Credit Card: 5425 2334 3010 9903</li>
    </ul>
  </div>

  <div class="content-box">
    <h2>Dynamic Content Test</h2>
    <p>Click the buttons below to dynamically add content with PII:</p>
    <button onclick="addEmail()">Add Email</button>
    <button onclick="addPhone()">Add Phone</button>
    <button onclick="addSSN()">Add SSN</button>
    <button onclick="addMixed()">Add Mixed PII</button>
    <button onclick="clearContent()">Clear</button>

    <div id="dynamic-content">
      <p><em>Dynamic content will appear here...</em></p>
    </div>
  </div>

  <div class="test-data">
    <h3>Test Instructions</h3>
    <ol>
      <li><strong>Initial Scan:</strong> The extension should detect PII in the static content on page load</li>
      <li><strong>Dynamic Content:</strong> Click the buttons above to add new content. The extension should detect PII in the dynamically added content.</li>
      <li><strong>Check Results:</strong> Open the extension popup to see detection logs</li>
    </ol>
    <p><strong>Expected:</strong> Both static and dynamically added PII should be detected and logged.</p>
  </div>

  <script>
    const contentDiv = document.getElementById('dynamic-content');

    // Cryptographically secure random number generator
    function secureRandom(max) {
      const crypto = window.crypto || window.msCrypto;
      const array = new Uint32Array(1);
      crypto.getRandomValues(array);
      return array[0] % max;
    }

    function addEmail() {
      const p = document.createElement('p');
      p.textContent = `New email added: user${secureRandom(1000)}@example.com`;
      contentDiv.appendChild(p);
    }

    function addPhone() {
      const p = document.createElement('p');
      p.textContent = `Phone number: (555) ${secureRandom(900) + 100}-${secureRandom(9000) + 1000}`;
      contentDiv.appendChild(p);
    }

    function addSSN() {
      const p = document.createElement('p');
      p.textContent = `SSN: ${secureRandom(900) + 100}-${secureRandom(90) + 10}-${secureRandom(9000) + 1000}`;
      contentDiv.appendChild(p);
    }

    function addMixed() {
      const div = document.createElement('div');
      const randomOctet = secureRandom(255);
      div.innerHTML = `
        <h4>User Profile</h4>
        <p>Email: testuser@example.com</p>
        <p>Phone: 555-0123</p>
        <p>IP: 10.0.0.${randomOctet}</p>
      `;
      contentDiv.appendChild(div);
    }

    function clearContent() {
      contentDiv.innerHTML = '<p><em>Dynamic content cleared...</em></p>';
    }
  </script>
</body>
</html>
